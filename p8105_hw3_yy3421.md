p8105_hw3_yy3421
================

## Problem 1

Loading dataset:

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.3     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.3     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "95%"
)
library(p8105.datasets)
data("instacart")
```

### Question 1:

Group by aisle:

``` r
instacart_aisle = instacart |> 
  group_by(aisle)
```

``` r
n_item_max = instacart_aisle |> 
  summarise(n_item=n()) |> 
  arrange(desc(n_item))
```

There are 134 aisles. The most items are ordered from aisle “fresh
vegetables” with 150609 items.

### Question 2:

``` r
n_item_max |> 
  filter(
    n_item > 10000
  ) |> 
  ggplot(aes(y= reorder(aisle, +n_item), x = n_item))+
  geom_bar(stat = "Identity") +
  labs(
    y = "Aisle",
    x = "Number of Items"
  )
```

<img src="p8105_hw3_yy3421_files/figure-gfm/unnamed-chunk-4-1.png" width="95%" />

### Question 3:

``` r
instacart_popular=
  instacart_aisle |> 
  group_by(aisle, product_name) |> 
  filter(
      aisle == "baking ingredients" | aisle == "dog food care" | aisle == "packaged vegetables fruits"
    ) |> 
  summarize(n_product = n()) |> 
  arrange(desc(n_product)) |> 
  mutate(
    product_rank = min_rank(desc(n_product))
    ) |> 
  filter(product_rank < 4) 
```

    ## `summarise()` has grouped output by 'aisle'. You can override using the
    ## `.groups` argument.

### Question 4:

``` r
instacart_day = 
  instacart |> 
  group_by(order_dow, product_name) |> 
  filter(
    product_name == "Pink Lady Apples"| product_name == "Coffee Ice Cream"
  ) |> 
  summarize(
    mean_hour = mean(order_hour_of_day)
  ) |> 
  mutate(
    order_dow = order_dow +1
  ) |> 
  pivot_wider(
    names_from = product_name,
    values_from = mean_hour
  )
```

    ## `summarise()` has grouped output by 'order_dow'. You can override using the
    ## `.groups` argument.
